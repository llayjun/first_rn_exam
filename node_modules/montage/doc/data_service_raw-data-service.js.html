<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: data/service/raw-data-service.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: data/service/raw-data-service.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>var DataService = require("data/service/data-service").DataService,
    DataMapping = require("data/service/data-mapping").DataMapping,
    DataIdentifier = require("data/model/data-identifier").DataIdentifier,
    Deserializer = require("core/serialization/deserializer/montage-deserializer").MontageDeserializer,
    Map = require("collections/map"),
    Montage = require("montage").Montage,
    WeakMap = require("collections/weak-map"),
    deprecate = require("core/deprecate");

/**
 * Provides data objects of certain types and manages changes to them based on
 * "raw" data obtained from or sent to one or more other services, typically
 * REST or other network services. Raw data services can therefore be considered
 * proxies for these REST or other services.
 *
 * Raw data services are usually the children of a
 * [data service]{@link DataService} that often is the application's
 * [main data service]{@link DataService.mainService}. All calls to raw data
 * services that have parent services must be routed through those parents.
 *
 * Raw data service subclasses that implement their own constructor should call
 * this class' constructor at the beginning of their constructor implementation
 * with code like the following:
 *
 *     RawDataService.call(this);
 *
 * @class
 * @extends DataService
 */
exports.RawDataService = DataService.specialize(/** @lends RawDataService.prototype */ {

    /***************************************************************************
     * Initializing
     */

    constructor: {
        value: function RawDataService() {
            DataService.call(this);
            this._typeIdentifierMap = new Map();
        }
    },

    /**
     * @deprecated
     */
    initWithModel: {
        value: function (model) {
            var self = this;
            return require.async(model).then(function (descriptor) {
                var deserializer = new Deserializer().init(JSON.stringify(descriptor), require);
                return deserializer.deserializeObject();
            }).then(function (model) {
                self.model = model;
                return self;
            });
        }
    },

    /***************************************************************************
     * Serialization
     */

    deserializeSelf: {
        value:function (deserializer) {

            this.super(deserializer);
        }
    },

    /*
     * The ConnectionDescriptor object where possible connections will be found
     *
     * @type {ConnectionDescriptor}
     */
    connectionDescriptor: {
        value: undefined
    },

    /*
     * The current DataConnection object used to connect to data source
     *
     * @type {DataConnection}
     */
    connection: {
        value: undefined
    },

    /***************************************************************************
     * Data Object Properties
     */

    // decacheObjectProperties: {
    //     value: function (object, propertyNames) {
    //         return this.rootService.decacheObjectProperties(object, propertyNames);
    //     }
    // },

    // getObjectProperties: {
    //     value: function (object, propertyNames) {
    //         return this.rootService.getObjectProperties(object, propertyNames);
    //     }
    // },

    // updateObjectProperties: {
    //     value: function (object, propertyNames) {
    //         return this.rootService.updateObjectProperties(object, propertyNames);
    //     }
    // },

    /**
     * Fetch the value of a data object's property, possibly asynchronously.
     *
     * The default implementation of this method just return a fulfilled promise
     * for `null`. Subclasses should override this method to perform any fetch
     * or other operation required to get the requested data. The subclass
     * implementations should only use calls to their
     * [root service's]{@link DataService.rootService}
     * [fetchData()]{@link DataService#fetchData} to fetch data.
     *
     * @method
     */
    // fetchObjectProperty: {
    //     value: function (object, propertyName) {
    //         var propertyDescriptor = this._propertyDescriptorForObjectAndName(object, propertyName),
    //             destinationReference = propertyDescriptor &amp;&amp; propertyDescriptor.valueDescriptor;
    //         return destinationReference ?   this._fetchObjectPropertyWithPropertyDescriptor(object, propertyName, propertyDescriptor) :
    //                                         this.nullPromise;
    //     }
    // },

    _propertyDescriptorForObjectAndName: {
        value: function (object, propertyName) {
            var objectDescriptor = this.objectDescriptorForObject(object);
            return objectDescriptor &amp;&amp; objectDescriptor.propertyDescriptorForName(propertyName);
        }
    },

    _objectDescriptorForObject: {
        value: function (object) {
            var types = this.types,
                objectInfo = Montage.getInfoForObject(object),
                moduleId = objectInfo.moduleId,
                objectName = objectInfo.objectName,
                module, exportName, objectDescriptor, i, n;
            for (i = 0, n = types.length; i &lt; n &amp;&amp; !objectDescriptor; i += 1) {
                module = types[i].module;
                exportName = module &amp;&amp; types[i].exportName;
                if (module &amp;&amp; moduleId === module.id &amp;&amp; objectName === exportName) {
                    objectDescriptor = types[i];
                }
            }
            return objectDescriptor;
            // var typeName = object.constructor.TYPE.typeName,
            //     isModel = this.model instanceof Model,
            //     isObjectDescriptor = !isModel &amp;&amp; this.model instanceof ObjectDescriptor,
            //     isObjectsObjectDescriptor = isObjectDescriptor &amp;&amp; this.model.name === typeName;
            // return  isModel ?                       this.model.objectDescriptorForName(typeName) :
            //     isObjectsObjectDescriptor ?     this.model :
            //         undefined;
        }
    },

    // _fetchObjectPropertyWithPropertyDescriptor: {
    //     value: function (object, propertyName, propertyDescriptor) {
    //         var self = this, moduleId, cachedDescriptor, service = this.rootService;
    //         return propertyDescriptor.valueDescriptor.then(function (objectDescriptor) {
    //             moduleId = [objectDescriptor.module.id, objectDescriptor.exportName].join("/");
    //             cachedDescriptor = self.rootService._moduleIdToObjectDescriptorMap[moduleId];
    //             var selector = DataQuery.withTypeAndCriteria(cachedDescriptor, {
    //                 // snapshot: self._snapshots.get(object),
    //                 source: object,
    //                 relationshipKey: propertyName
    //             });
    //             return service.fetchData(selector);
    //         }).then(function (data) {
    //             return self._mapObjectPropertyValue(object, propertyDescriptor, data);
    //         });
    //         // return this._objectDescriptorTypeForValueDescriptor(propertyDescriptor.valueDescriptor).then(function (type) {
    //         //     var selector = DataQuery.withTypeAndCriteria(type, {
    //         //         snapshot: self._snapshots.get(object),
    //         //         source: object,
    //         //         relationshipKey: propertyName
    //         //     });
    //         //     return service.fetchData(selector);
    //         // }).then(function (data) {
    //         //     return self._mapObjectPropertyValue(object, propertyDescriptor, data);
    //         // });
    //     }
    // },

    _mapObjectPropertyValue: {
        value: function (object, propertyDescriptor, value) {
            var propertyName = propertyDescriptor.name;
            if (propertyDescriptor.cardinality === Infinity) {
                this.spliceWithArray(object[propertyName], value);
            } else {
                object[propertyName] = value[0];
            }

            if (propertyDescriptor.inversePropertyName &amp;&amp; value &amp;&amp; value[0]) {
                var inverseBlueprint = this._propertyDescriptorForObjectAndName(value[0], propertyDescriptor.inversePropertyName);
                if (inverseBlueprint &amp;&amp; inverseBlueprint.cardinality === 1) {
                    value.forEach(function (inverseObject) {
                        inverseObject[propertyDescriptor.inversePropertyName] = object;
                    });
                }
            }
            return value;
        }
    },

    _objectDescriptorTypeForValueDescriptor: {
        value: function (valueDescriptor) {
            return valueDescriptor.then(function (objectDescriptor) {
                return objectDescriptor.module.require.async(objectDescriptor.module.id);
            });
        }
    },

    /***************************************************************************
     * Data Object Creation
     *
     * If there were no mapping available in the app for this record giving use
     * a type/class/condtructor, we should create one ourselves matching what we know.
     * For a REST service it would be the name of the Entity. Otherwise we should be able
     * to treat by ip domain, a type based on concatenation of all keys returned,
     * which would define the "shape"
     *
     */

    // getDataObject: {
    //     value: function (type, data, context, dataIdentifier) {
    //         return this.rootService.getDataObject(type, data, context, dataIdentifier);
    //     }
    // },

    // createDataObject: {
    //     value: function (type) {
    //         return this.rootService.createDataObject(type);
    //     }
    // },

    /***************************************************************************
     * Data Object Changes
     */

    // createdDataObjects: {
    //     get: function () {
    //         return this.rootService.createdDataObjects();
    //     }
    // },

    // changedDataObjects: {
    //     get: function () {
    //         return this.rootService.changedDataObjects();
    //     }
    // },

    /***************************************************************************
     * Fetching Data
     */

    /**
     * Fetch data from this service for its parent. This method should not be
     * called directly by anyone other than this service's parent. Calls to the
     * root service should be made to initiate data fetches.
     *
     * Subclasses may override this method to fetch the requested data, but will
     * usually override [fetchRawData()]{@link RawDataService#fetchRawData}
     * instead.
     *
     * This method must be asynchronous and return as soon as possible even if
     * it takes a while to generate the requested data objects. The data objects
     * can be generated and added to the specified stream at any point after
     * this method is called, even after it returns, with calls to
     * [addData()]{@link DataStream#addData} and
     * [dataDone()]{@link DataStream#dataDone}. Usually this will be done by
     * having [fetchRawData()]{@link RawDataService#fetchRawData} make calls to
     * [addRawData()]{@link RawDataService#addRawData} and
     * [rawDataDone()]{@link RawDataService#rawDataDone}.
     *
     * The default implementation of this method calls
     * [fetchRawData()]{@link RawDataService#fetchRawData}.
     *
     * @method
     * @argument {DataObjectDescriptor|DataQuery}
     *           typeOrSelector        - Defines what data should be returned.
     *                                   If a [type]{@link DataOjectDescriptor}
     *                                   is provided instead of a
     *                                   {@link DataQuery}, a `DataQuery`
     *                                   with the specified type and no
     *                                   [criteria]{@link DataQuery#criteria}
     *                                   will be created and used for the fetch.
     * @argument {?DataStream} stream  - The stream to which the provided data
     *                                   should be added. If no stream is
     *                                   provided a stream will be created and
     *                                   returned by this method.
     * @returns {?DataStream} - The stream to which the fetched data objects
     * were or will be added, whether this stream was provided to or created by
     * this method.
     */
    // fetchData: {
    //     value: function (queryOrType, stream) {
    //         var isSupportedType = queryOrType instanceof DataObjectDescriptor || queryOrType instanceof ObjectDescriptor,
    //             type = isSupportedType &amp;&amp; queryOrType,
    //             query = type &amp;&amp; DataQuery.withTypeAndCriteria(type) || queryOrType;
    //         stream = stream || new DataStream();
    //         stream.query = query;
    //         this._fetchRawData(stream);
    //         return stream;
    //     }
    // },

    // fetchData: {
    //     value: function (queryOrType, stream) {
    //         var self = this,
    //              isSupportedType = queryOrType instanceof DataObjectDescriptor || queryOrType instanceof ObjectDescriptor,
    //             type = isSupportedType &amp;&amp; queryOrType,
    //             query = type &amp;&amp; DataQuery.withTypeAndCriteria(type) || queryOrType;
    //         // Set up the stream.
    //         stream = stream || new DataStream();
    //         stream.query = query;
    //             // Use a child service to fetch the data.
    //             var service;
    //             try {
    //                 service = self.childServiceForType(query.type);
    //                 if (service &amp;&amp; service!==self) {
    //                     stream = service.fetchData(query, stream) || stream;
    //                     self._dataServiceByDataStream.set(stream, service);
    //                 } else {
    //                     if(typeof self.fetchRawData === "function") {
    //                         self._fetchRawData(stream);
    //                     }
    //                     else {
    //                         throw new Error("Can't fetch data of unknown type - " + query.type.typeName + "/" + query.type.uuid);
    //                     }
    //                 }
    //             } catch (e) {
    //                 stream.dataError(e);
    //             }
    //         // Return the passed in or created stream.
    //         return stream;
    //     }
    // },

    /**
     * Fetch the raw data of this service.
     *
     * This method should not be called directly from anyone other than this
     * service's [fetchData()]{@link RawDataService#fetchData}.
     *
     * Subclasses that don't override
     * [fetchData()]{@link RawDataService#fetchData} should override this method
     * to:
     *
     *   1. Fetch the raw records needed to generate the requested data object.
     *
     *   2. Add those records to the specified stream with calls to
     *      [addRawData()]{@link RawDataService#addRawData}.
     *
     *   3. Indicate that the fetching is done with a call to
     *      [rawDataDone()]{@link RawDataService#rawDataDone}.
     *
     * This method must be asynchronous and return as soon as possible even if
     * it takes a while to obtain the raw data. The raw data can be provided to
     * the service at any point after this method is called, even after it
     * returns, with calls to [addRawData()]{@link RawDataService#addRawData}
     * and [rawDataDone()]{@link RawDataService#rawDataDone}.
     *
     * The default implementation of this method simply calls
     * [rawDataDone()]{@link RawDataService#rawDataDone} immediately.
     *
     * @method
     * @argument {DataStream} stream - The stream to which the data objects
     *                                 corresponding to the raw data should be
     *                                 added. This stream must contain a
     *                                 reference to the selector defining what
     *                                 raw data to fetch.
     */
    // TODO, swizzling the stream's user-land selector for the rawData equivalent is not really
    // practical nor safe, we either need to keep it separately or store it on the stream under
    // rawDataQuery

    // _fetchRawData: {
    //     value: function (stream) {
    //         var self = this;
    //         this.authorizationPromise.then(function (authorization) {
    //             var streamSelector = stream.query;
    //             stream.query = self.mapSelectorToRawDataQuery(streamSelector);
    //             self.fetchRawData(stream);
    //             stream.query = streamSelector;
    //         })
    //     }
    // },

    _fetchRawData: {
        value: function (stream) {
            var self = this,
                childService = this._childServiceForQuery(stream.query),
                query = stream.query;

            //TODO [TJ] Determine purpose of this check...
            // if (childService &amp;&amp; childService.identifier.indexOf("offline-service") === -1) {
            //     childService._fetchRawData(stream);
            // } else
            if (childService) {
                childService.fetchRawData(stream);
            } else if (query.authorization) {
                stream.query = self.mapSelectorToRawDataQuery(query);
                self.fetchRawData(stream);
                stream.query = query;
            } else if (this.authorizationPolicy === DataService.AuthorizationPolicy.NONE) {
                stream.query = self.mapSelectorToRawDataQuery(query);
                self.fetchRawData(stream);
                stream.query = query;
            } else {
                DataService.authorizationManager.authorizeService(this).then(function(authorization) {
                    self.authorization = authorization;
                    return authorization;
                }).catch(function(error) {
                    console.log(error);
                }).then(function (authorization) {
                    stream.query = self.mapSelectorToRawDataQuery(query);
                    self.fetchRawData(stream);
                    stream.query = query;
                });
            }
        }
    },

    fetchRawData: {
        value: function (stream) {
            this.rawDataDone(stream);
        }
    },

    /**
     * Called through MainService when consumer has indicated that he has lost interest in the passed DataStream.
     * This will allow the RawDataService feeding the stream to take appropriate measures.
     *
     * @method
     * @argument {DataStream} [dataStream] - The DataStream to cancel
     * @argument {Object} [reason] - An object indicating the reason to cancel.
     *
     */
    cancelRawDataStream: {
        value: function (dataStream, reason) {
        }
    },
    /***************************************************************************
     * Saving Data
     */

    /**
     * Subclasses should override this method to delete a data object when that
     * object's raw data wouldn't be useful to perform the deletion.
     *
     * The default implementation maps the data object to raw data and calls
     * [deleteRawData()]{@link RawDataService#deleteRawData} with the data
     * object passed in as the `context` argument of that method.
     *
     * @method
     * @argument {Object} object   - The object to delete.
     * @returns {external:Promise} - A promise fulfilled when the object has
     * been deleted. The promise's fulfillment value is not significant and will
     * usually be `null`.
     */
    deleteDataObject: {
        value: function (object) {
            var record = {};
            this._mapObjectToRawData(object, record);
            return this.deleteRawData(record, object);
        }
    },

    /**
     * Subclasses should override this method to delete a data object when that
     * object's raw data would be useful to perform the deletion.
     *
     * @method
     * @argument {Object} record   - An object whose properties hold the raw
     *                               data of the object to delete.
     * @argument {?} context       - An arbitrary value sent by
     *                               [deleteDataObject()]{@link RawDataService#deleteDataObject}.
     *                               By default this is the object to delete.
     * @returns {external:Promise} - A promise fulfilled when the object's data
     * has been deleted. The promise's fulfillment value is not significant and
     * will usually be `null`.
     */
    deleteRawData: {
        value: function (record, context) {
            // Subclasses must override this.
            return this.nullPromise;
        }
    },

    /**
     * Subclasses should override this method to save a data object when that
     * object's raw data wouldn't be useful to perform the save.
     *
     * The default implementation maps the data object to raw data and calls
     * [saveRawData()]{@link RawDataService#saveRawData} with the data object
     * passed in as the `context` argument of that method.
     *
     * @method
     * @argument {Object} object   - The object to save.
     * @returns {external:Promise} - A promise fulfilled when all of the data in
     * the changed object has been saved. The promise's fulfillment value is not
     * significant and will usually be `null`.
     */
    // saveDataObject: {
    //     value: function (object) {
    //         var record = {};
    //         this._mapObjectToRawData(object, record);
    //         return this.saveRawData(record, object);
    //     }
    // },

    /**
     * Subclasses should override this method to save a data object when that
     * object's raw data would be useful to perform the save.
     *
     * @method
     * @argument {Object} record   - An object whose properties hold the raw
     *                               data of the object to save.
     * @argument {?} context       - An arbitrary value sent by
     *                               [saveDataObject()]{@link RawDataService#saveDataObject}.
     *                               By default this is the object to save.
     * @returns {external:Promise} - A promise fulfilled when the object's data
     * has been saved. The promise's fulfillment value is not significant and
     * will usually be `null`.
     */
    saveRawData: {
        value: function (record, context) {
            // Subclasses must override this.
            return this.nullPromise;
        }
    },

    /***************************************************************************
     * Offline
     */

    /*
     * Returns the [root service's offline status]{@link DataService#isOffline}.
     *
     * @type {boolean}
     */
    isOffline: {
        get: function () {
            return this === this.rootService ?
                    this.superForGet("isOffline")() :
                        this.rootService.isOffline;
        }
    },

    /**
     * Called with all the data passed to
     * [addRawData()]{@link RawDataService#addRawData} to allow storing of that
     * data for offline use.
     *
     * The default implementation does nothing. This is appropriate for
     * subclasses that do not support offline operation or which operate the
     * same way when offline as when online.
     *
     * Other subclasses may override this method to store data fetched when
     * online so [fetchData]{@link RawDataSource#fetchData} can use that data
     * when offline.
     *
     * @method
     * @argument {Object} records  - An array of objects whose properties' values
     *                               hold the raw data.
     * @argument {?DataQuery} selector
     *                             - Describes how the raw data was selected.
     * @argument {?} context       - The value that was passed in to the
     *                               [rawDataDone()]{@link RawDataService#rawDataDone}
     *                               call that invoked this method.
     * @returns {external:Promise} - A promise fulfilled when the raw data has
     * been saved. The promise's fulfillment value is not significant and will
     * usually be `null`.
     */
    writeOfflineData: {
        value: function (records, selector, context) {
            // Subclasses should override this to do something useful.
            return this.nullPromise;
        }
    },

    /***************************************************************************
     * Collecting Raw Data
     */

    /**
     * To be called by [fetchData()]{@link RawDataService#fetchData} or
     * [fetchRawData()]{@link RawDataService#fetchRawData} when raw data records
     * are received. This method should never be called outside of those
     * methods.
     *
     * This method creates and registers the data objects that
     * will represent the raw records with repeated calls to
     * [getDataObject()]{@link DataService#getDataObject}, maps
     * the raw data to those objects with repeated calls to
     * [mapRawDataToObject()]{@link RawDataService#mapRawDataToObject},
     * and then adds those objects to the specified stream.
     *
     * Subclasses should not override this method and instead override their
     * [getDataObject()]{@link DataService#getDataObject} method, their
     * [mapRawDataToObject()]{@link RawDataService#mapRawDataToObject} method,
     * their [mapping]{@link RawDataService#mapping}'s
     * [mapRawDataToObject()]{@link RawDataMapping#mapRawDataToObject} method,
     * or several of these.
     *
     * @method
     * @argument {DataStream} stream
     *                           - The stream to which the data objects created
     *                             from the raw data should be added.
     * @argument {Array} records - An array of objects whose properties'
     *                             values hold the raw data. This array
     *                             will be modified by this method.
     * @argument {?} context     - An arbitrary value that will be passed to
     *                             [getDataObject()]{@link RawDataService#getDataObject}
     *                             and
     *                             [mapRawDataToObject()]{@link RawDataService#mapRawDataToObject}
     *                             if it is provided.
     */
    addRawData: {
        value: function (stream, records, context) {
            var offline, i, n,
                streamSelectorType = stream.query.type,
                iRecord;
            // Record fetched raw data for offline use if appropriate.
            offline = records &amp;&amp; !this.isOffline &amp;&amp; this._streamRawData.get(stream);
            if (offline) {
                offline.push.apply(offline, records);
            } else if (records &amp;&amp; !this.isOffline) {
                this._streamRawData.set(stream, records.slice());
            }
            // Convert the raw data to appropriate data objects. The conversion
            // will be done in place to avoid creating any unnecessary array.
            for (i = 0, n = records &amp;&amp; records.length; i &lt; n; i += 1) {
                iRecord = records[i];
                /*jshint -W083*/
                // Turning off jshint's function within loop warning because the
                // only "outer scoped variable" we're accessing here is stream,
                // which is a constant reference and won't cause unexpected
                // behavior due to iteration.
                this.addOneRawData(stream, iRecord, context, streamSelectorType).then(function (mappedObject) {
                    stream.addData([mappedObject]);
                });
                /*jshint +W083*/
            }
        }
    },


    addOneRawData: {
        value: function (stream, rawData, context) {
            var object = this.objectForTypeRawData(stream.query.type, rawData, context),
                result;

            result = this._mapRawDataToObject(rawData, object, context);

            if (result &amp;&amp; result instanceof Promise) {
                result = result.then(function () {
                    return object;
                });
            } else {
                result = Promise.resolve(object);
            }
            this._addMapDataPromiseForStream(result, stream);

            if (object) {
                this.callDelegateMethod("rawDataServiceDidAddOneRawData", this, stream, rawData, object);
            }
            return result;
        }
    },

    _addMapDataPromiseForStream: {
        value: function (promise, stream) {
            if (!this._streamMapDataPromises.has(stream)) {
                this._streamMapDataPromises.set(stream, [promise]);
            } else {
                this._streamMapDataPromises.get(stream).push(promise);
            }
        }
    },

    _streamMapDataPromises: {
        get: function () {
            if (!this.__streamMapDataPromises) {
                this.__streamMapDataPromises = new Map();
            }
            return this.__streamMapDataPromises;
        }
    },

    objectForTypeRawData: {
        value:function(type, rawData, context) {
                var dataIdentifier = this.dataIdentifierForTypeRawData(type,rawData);
                //Record snapshot before we may create an object
                this.recordSnapshot(dataIdentifier, rawData);
               //iDataIdentifier argument should be all we need later on
                return this.getDataObject(type, rawData, context, dataIdentifier);
        }
    },

    _typeIdentifierMap: {
        value: undefined
    },

    //This should belong on the
    //Gives us an indirection layer to deal with backward compatibility.
    dataIdentifierForTypeRawData: {
        value: function (type, rawData) {

            var mapping = this.mappingWithType(type),
                rawDataPrimaryKeys = mapping ? mapping.rawDataPrimaryKeys : null,
                rawDataPrimaryKeysValues,
                dataIdentifier, dataIdentifierMap, primaryKey;
            if(rawDataPrimaryKeys &amp;&amp; rawDataPrimaryKeys.length) {

                dataIdentifierMap = this._typeIdentifierMap.get(type);

                if(!dataIdentifierMap) {
                    this._typeIdentifierMap.set(type,(dataIdentifierMap = new Map()));
                }

                for(var i=0, iKey;(iKey = rawDataPrimaryKeys[i]);i++) {
                    rawDataPrimaryKeysValues = rawDataPrimaryKeysValues || [];
                    rawDataPrimaryKeysValues[i] = rawData[iKey];
                }
                if(rawDataPrimaryKeysValues) {
                    primaryKey = rawDataPrimaryKeysValues.join("/");
                    dataIdentifier = dataIdentifierMap.get(primaryKey);
                }

                if(!dataIdentifier) {
                    var typeName = type.typeName /*DataDescriptor*/ || type.name;
                        //This should be done by ObjectDescriptor/blueprint using primaryProperties
                        //and extract the corresponsing values from rawData
                        //For now we know here that MileZero objects have an "id" attribute.
                        dataIdentifier = new DataIdentifier();
                        dataIdentifier.objectDescriptor = type;
                        dataIdentifier.dataService = this;
                        dataIdentifier.typeName = type.name;
                        dataIdentifier._identifier = dataIdentifier.primaryKey = primaryKey;

                        dataIdentifierMap.set(primaryKey,dataIdentifier);
                }
                return dataIdentifier;
            }
            return undefined;
        }
    },

    __snapshot: {
        value: null
    },

    _snapshot: {
        get: function() {
            return this.__snapshot || (this.__snapshot = new Map());
        }
    },


    /**
     * Records the snapshot of the values of record known for a DataIdentifier
     *
     * @private
     * @argument  {DataIdentifier} dataIdentifier
     * @argument  {Object} rawData
     */
    recordSnapshot: {
        value: function (dataIdentifier, rawData) {
            this._snapshot.set(dataIdentifier, rawData);
        }
    },

    /**
     * Removes the snapshot of the values of record for the DataIdentifier argument
     *
     * @private
     * @argument {DataIdentifier} dataIdentifier
     */
   removeSnapshot: {
        value: function (dataIdentifier) {
            this._snapshot.delete(dataIdentifier);
        }
    },

    /**
     * Returns the snapshot associated with the DataIdentifier argument if available
     *
     * @private
     * @argument {DataIdentifier} dataIdentifier
     */
   snapshotForDataIdentifier: {
        value: function (dataIdentifier) {
            return this._snapshot.get(dataIdentifier);
       }
    },

    /**
     * Returns the snapshot associated with the DataIdentifier argument if available
     *
     * @private
     * @argument {DataIdentifier} dataIdentifier
     */
   snapshotForObject: {
        value: function (object) {
            return this.snapshotForDataIdentifier(this.dataIdentifierForObject(object));
        }
    },

    /**
     * To be called once for each [fetchData()]{@link RawDataService#fetchData}
     * or [fetchRawData()]{@link RawDataService#fetchRawData} call received to
     * indicate that all the raw data meant for the specified stream has been
     * added to that stream.
     *
     * Subclasses should not override this method.
     *
     * @method
     * @argument {DataStream} stream - The stream to which the data objects
     *                                 corresponding to the raw data have been
     *                                 added.
     * @argument {?} context         - An arbitrary value that will be passed to
     *                                 [writeOfflineData()]{@link RawDataService#writeOfflineData}
     *                                 if it is provided.
     */
    rawDataDone: {
        value: function (stream, context) {
            var self = this,
                dataToPersist = this._streamRawData.get(stream),
                mappingPromises = this._streamMapDataPromises.get(stream),
                dataReadyPromise = mappingPromises ? Promise.all(mappingPromises) : this.nullPromise;

            if (mappingPromises) {
                this._streamMapDataPromises.delete(stream);
            }

            if (dataToPersist) {
                this._streamRawData.delete(stream);
            }

            dataReadyPromise.then(function (results) {

                return dataToPersist ? self.writeOfflineData(dataToPersist, stream.query, context) : null;
            }).then(function () {
                stream.dataDone();
                return null;
            }).catch(function (e) {
                console.error(e);
            });

        }
    },

    /**
     * Records in the process of being written to streams (after
     * [addRawData()]{@link RawDataService#addRawData} has been called and
     * before [rawDataDone()]{@link RawDataService#rawDataDone} is called for
     * any given stream). This is used to collect raw data that needs to be
     * stored for offline use.
     *
     * @private
     * @type {Object.&lt;Stream, records>}
     */
    _streamRawData: {
        get: function () {
            if (!this.__streamRawData) {
                this.__streamRawData = new WeakMap();
            }
            return this.__streamRawData;
        }
    },

    __streamRawData: {
        value: undefined
    },

    /***************************************************************************
     * Mapping Raw Data
     */

    /**
     * Convert a selector for data objects to a selector for raw data.
     *
     * The selector returned by this method will be the selector used by methods
     * that deal with raw data, like
     * [fetchRawData()]{@link RawDataService#fetchRawData]},
     * [addRawData()]{@link RawDataService#addRawData]},
     * [rawDataDone()]{@link RawDataService#rawDataDone]}, and
     * [writeOfflineData()]{@link RawDataService#writeOfflineData]}. Any
     * [stream]{@link DataStream} available to these methods will have their
     * selector references temporarly replaced by references to the mapped
     * selector returned by this method.
     *
     * The default implementation of this method returns the passed in selector.
     *
     * @method
     * @argument {DataQuery} selector - A selector defining data objects to
     *                                     select.
     * @returns {DataQuery} - A selector defining raw data to select.
     */
    mapSelectorToRawDataQuery: {
        value: function (query) {
            return query;
        }
    },

    mapSelectorToRawDataSelector: {
        value: deprecate.deprecateMethod(void 0, function (selector) {
            return this.mapSelectorToRawDataQuery(selector);
        }, "mapSelectorToRawDataSelector", "mapSelectorToRawDataQuery"),
    },

    /**
     * Convert raw data to data objects of an appropriate type.
     *
     *
     * @todo Make this method overridable by type name with methods like
     * `mapRawDataToHazard()` and `mapRawDataToProduct()`.
     *
     * @method
     * @argument {Object} record - An object whose properties' values hold
     *                             the raw data.
     * @argument {Object} object - An object whose properties must be set or
     *                             modified to represent the raw data.
     * @argument {?} context     - The value that was passed in to the
     *                             [addRawData()]{@link RawDataService#addRawData}
     *                             call that invoked this method.
     */
    mappingForObject: {
        value: function (object) {
            var objectDescriptor = this.objectDescriptorForObject(object),
                mapping = objectDescriptor &amp;&amp; this.mappingWithType(objectDescriptor);

            if (!mapping &amp;&amp; objectDescriptor) {
                mapping = this._objectDescriptorMappings.get(objectDescriptor);
                if (!mapping) {
                    mapping = DataMapping.withObjectDescriptor(objectDescriptor);
                    this._objectDescriptorMappings.set(objectDescriptor, mapping);
                }
            }

            return mapping;
        }
    },

    /**
     * Convert raw data to data objects of an appropriate type.
     *
     * Subclasses should override this method to map properties of the raw data
     * to data objects:
     * @method
     * @argument {Object} record - An object whose properties' values hold
     *                             the raw data.
     * @argument {Object} object - An object whose properties must be set or
     *                             modified to represent the raw data.
     * @argument {?} context     - The value that was passed in to the
     *                             [addRawData()]{@link RawDataService#addRawData}
     *                             call that invoked this method.
     */


    mapRawDataToObject: {
        value: function (rawData, object, context) {
            // return this.mapFromRawData(object, record, context);
        }
    },
    /**
     * Convert raw data to data objects of an appropriate type.
     *
     * Subclasses should override this method to map properties of the raw data
     * to data objects, as in the following:
     *
     *     mapRawDataToObject: {
     *         value: function (object, record) {
     *             object.firstName = record.GIVEN_NAME;
     *             object.lastName = record.FAMILY_NAME;
     *         }
     *     }
     *
     * Alternatively, subclasses can define a
     * [mapping]{@link DataService#mapping} to do this mapping.
     *
     * The default implementation of this method uses the service's mapping if
     * the service has one, and otherwise calls the deprecated
     * [mapFromRawData()]{@link RawDataService#mapFromRawData}, whose default
     * implementation does nothing.
     *
     * @todo Make this method overridable by type name with methods like
     * `mapRawDataToHazard()` and `mapRawDataToProduct()`.
     *
     * @method
     * @argument {Object} record - An object whose properties' values hold
     *                             the raw data.
     * @argument {Object} object - An object whose properties must be set or
     *                             modified to represent the raw data.
     * @argument {?} context     - The value that was passed in to the
     *                             [addRawData()]{@link RawDataService#addRawData}
     *                             call that invoked this method.
     */
    _mapRawDataToObject: {
        value: function (record, object, context) {
            var self = this,
                mapping = this.mappingForObject(object),
                result;

            if (mapping) {
                result = mapping.mapRawDataToObject(record, object, context);
                if (result) {
                    result = result.then(function () {
                        return self.mapRawDataToObject(record, object, context);
                    });
                } else {
                    result = this.mapRawDataToObject(record, object, context);
                }
            } else {
                result = this.mapRawDataToObject(record, object, context);
            }

            return result;

        }
    },

    /**
     * Public method invoked by the framework during the conversion from
     * an object to a raw data.
     * Designed to be overriden by concrete RawDataServices to allow fine-graine control
     * when needed, beyond transformations offered by an ObjectDescriptorDataMapping or
     * an ExpressionDataMapping
     *
     * @method
     * @argument {Object} object - An object whose properties must be set or
     *                             modified to represent the raw data.
     * @argument {Object} record - An object whose properties' values hold
     *                             the raw data.
     * @argument {?} context     - The value that was passed in to the
     *                             [addRawData()]{@link RawDataService#addRawData}
     *                             call that invoked this method.
     */
    mapObjectToRawData: {
        value: function (object, record, context) {
            // this.mapToRawData(object, record, context);
        }
    },

    /**
     * @todo Document.
     * @todo Make this method overridable by type name with methods like
     * `mapHazardToRawData()` and `mapProductToRawData()`.
     *
     * @method
     */
    _mapObjectToRawData: {
        value: function (object, record, context) {
            var mapping = this.mappingForObject(object),
                result;

            if (mapping) {
                result = mapping.mapObjectToRawData(object, record, context);
            }

            if (record) {
                if (result) {
                    var otherResult = this.mapObjectToRawData(object, record, context);
                    if (result instanceof Promise &amp;&amp; otherResult instanceof Promise) {
                        result = Promise.all([result, otherResult]);
                    } else if (otherResult instanceof Promise) {
                        result = otherResult;
                    }
                } else {
                    result = this.mapObjectToRawData(object, record, context);
                }
            }

            return result;
        }
    },

    // /**
    //  * If defined, used by
    //  * [mapRawDataToObject()]{@link RawDataService#mapRawDataToObject} and
    //  * [mapObjectToRawData()]{@link RawDataService#mapObjectToRawData} to map
    //  * between the raw data on which this service is based and the typed data
    //  * objects which this service provides and manages.
    //  *
    //  * @type {?DataMapping}
    //  */
    // mapping: {
    //     value: undefined
    // },

    _mappingsPromise: {
        get: function () {
            if (!this.__mappingsPromise) {
                this.__mappingsPromise = Promise.all(this.mappings.map(function (mapping) {
                    return mapping.objectDescriptor;
                })).then(function (values) {

                });
            }
            return this.__mappingsPromise;
        }
    },

    _objectDescriptorMappings: {
        get: function () {
            if (!this.__objectDescriptorMappings) {
                this.__objectDescriptorMappings = new Map();
            }
            return this.__objectDescriptorMappings;
        }
    },

    /***************************************************************************
     * Deprecated
     */

    /**
     * @todo Document deprecation in favor of
     * [mapRawDataToObject()]{@link RawDataService#mapRawDataToObject}
     *
     * @deprecated
     * @method
     */
    mapFromRawData: {
        value: function (object, record, context) {
            // Implemented by subclasses.
        }
    },

    /**
     * @todo Document deprecation in favor of
     * [mapObjectToRawData()]{@link RawDataService#mapObjectToRawData}
     *
     * @deprecated
     * @method
     */
    mapToRawData: {
        value: function (object, record) {
            // Implemented by subclasses.
        }
    },

    /**
     * @todo Remove any dependency and delete.
     *
     * @deprecated
     * @type {OfflineService}
     */
    offlineService: {
        value: undefined
    }

});
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-_._foo.reel_.html">"./foo.reel"</a></li><li><a href="module-_montage_ui_condition.reel_.html">"montage/ui/condition.reel"</a></li><li><a href="module-_montage_ui_flow.reel_.html">"montage/ui/flow.reel"</a></li><li><a href="module-_montage_ui_input-radio.reel_.html">"montage/ui/input-radio.reel"</a></li><li><a href="module-_montage_ui_label.reel_.html">"montage/ui/label.reel"</a></li><li><a href="module-_montage_ui_loader.reel_.html">"montage/ui/loader.reel"</a></li><li><a href="module-_montage_ui_native_button.reel_.html">"montage/ui/native/button.reel"</a></li><li><a href="module-_montage_ui_native_checkbox.reel_.html">"montage/ui/native/checkbox.reel"</a></li><li><a href="module-_montage_ui_native_image.reel_.html">"montage/ui/native/image.reel"</a></li><li><a href="module-_montage_ui_native_input-date.reel_.html">"montage/ui/native/input-date.reel"</a></li><li><a href="module-_montage_ui_native_input-number.reel_.html">"montage/ui/native/input-number.reel"</a></li><li><a href="module-_montage_ui_native_input-range.reel_.html">"montage/ui/native/input-range.reel"</a></li><li><a href="module-_montage_ui_native_input-text.reel_.html">"montage/ui/native/input-text.reel"</a></li><li><a href="module-_montage_ui_native_progress.reel_.html">"montage/ui/native/progress.reel"</a></li><li><a href="module-_montage_ui_native_select.reel_.html">"montage/ui/native/select.reel"</a></li><li><a href="module-_montage_ui_native_textarea.reel_.html">"montage/ui/native/textarea.reel"</a></li><li><a href="module-_montage_ui_repetition.reel_.html">"montage/ui/repetition.reel"</a></li><li><a href="module-_montage_ui_segmented-bar.reel_.html">"montage/ui/segmented-bar.reel"</a></li><li><a href="module-_montage_ui_slot.reel_.html">"montage/ui/slot.reel"</a></li><li><a href="module-_montage_ui_substitution.reel_.html">"montage/ui/substitution.reel"</a></li><li><a href="module-_montage_ui_succession.reel_.html">"montage/ui/succession.reel"</a></li><li><a href="module-_montage_ui_text.reel_.html">"montage/ui/text.reel"</a></li><li><a href="module-_native_ui_anchor.reel_.html">"native/ui/anchor.reel"</a></li><li><a href="module-_ui_main.reel_.html">"ui/main.reel"</a></li><li><a href="module-_ui_modal-overlay.reel_.html">"ui/modal-overlay.reel"</a></li><li><a href="module-_ui_overlay.reel_.html">"ui/overlay.reel"</a></li><li><a href="module-_ui_segmented-bar.reel_segment.reel_.html">"ui/segmented-bar.reel/segment.reel"</a></li><li><a href="module-core_application.html">core/application</a></li><li><a href="module-montage_composer_composer.html">montage/composer/composer</a></li><li><a href="module-montage_composer_key-composer.html">montage/composer/key-composer</a></li><li><a href="module-montage_composer_press-composer.html">montage/composer/press-composer</a></li><li><a href="module-montage_composer_swipe-composer.html">montage/composer/swipe-composer</a></li><li><a href="module-montage_composer_translate-composer.html">montage/composer/translate-composer</a></li><li><a href="module-montage_core_bindings.html">montage/core/bindings</a></li><li><a href="module-montage_core_bitfield.html">montage/core/bitfield</a></li><li><a href="module-montage_core_converter_bytes-converter.html">montage/core/converter/bytes-converter</a></li><li><a href="module-montage_core_converter_camel-case-converter.html">montage/core/converter/camel-case-converter</a></li><li><a href="module-montage_core_converter_converter.html">montage/core/converter/converter</a></li><li><a href="module-montage_core_converter_currency-converter.html">montage/core/converter/currency-converter</a></li><li><a href="module-montage_core_converter_date-converter.html">montage/core/converter/date-converter</a></li><li><a href="module-montage_core_converter_invert-converter.html">montage/core/converter/invert-converter</a></li><li><a href="module-montage_core_converter_kebab-case-converter.html">montage/core/converter/kebab-case-converter</a></li><li><a href="module-montage_core_converter_lower-case-converter.html">montage/core/converter/lower-case-converter</a></li><li><a href="module-montage_core_converter_new-line-to-br-converter.html">montage/core/converter/new-line-to-br-converter</a></li><li><a href="module-montage_core_converter_number-converter.html">montage/core/converter/number-converter</a></li><li><a href="module-montage_core_converter_number-to-nearest-integer-converter.html">montage/core/converter/number-to-nearest-integer-converter</a></li><li><a href="module-montage_core_converter_snake-case-converter.html">montage/core/converter/snake-case-converter</a></li><li><a href="module-montage_core_converter_trim-converter.html">montage/core/converter/trim-converter</a></li><li><a href="module-montage_core_converter_upper-case-converter.html">montage/core/converter/upper-case-converter</a></li><li><a href="module-montage_core_core.html">montage/core/core</a></li><li><a href="module-montage_core_deprecate.html">montage/core/deprecate</a></li><li><a href="module-montage_core_dom.html">montage/core/dom</a></li><li><a href="module-montage_core_enum.html">montage/core/enum</a></li><li><a href="module-montage_core_event_action-event-listener.html">montage/core/event/action-event-listener</a></li><li><a href="module-montage_core_event_event-manager.html">montage/core/event/event-manager</a></li><li><a href="module-montage_core_event_key-manager.html">montage/core/event/key-manager</a></li><li><a href="module-montage_core_event_mutable-event.html">montage/core/event/mutable-event</a></li><li><a href="module-montage_core_exception.html">montage/core/exception</a></li><li><a href="module-montage_core_extras_date.html">montage/core/extras/date</a></li><li><a href="module-montage_core_extras_function.html">montage/core/extras/function</a></li><li><a href="module-montage_core_extras_object.html">montage/core/extras/object</a></li><li><a href="module-montage_core_extras_string.html">montage/core/extras/string</a></li><li><a href="module-montage_core_gate.html">montage/core/gate</a></li><li><a href="module-montage_core_geometry_cubic-bezier.html">montage/core/geometry/cubic-bezier</a></li><li><a href="module-montage_core_geometry_point.html">montage/core/geometry/point</a></li><li><a href="module-montage_core_localizer.html">montage/core/localizer</a></li><li><a href="module-montage_core_logger.html">montage/core/logger</a></li><li><a href="module-montage_core_meta_validation-rule.html">montage/core/meta/validation-rule</a></li><li><a href="module-montage_core_module-reference.html">montage/core/module-reference</a></li><li><a href="module-montage_core_object-controller.html">montage/core/object-controller</a></li><li><a href="module-montage_core_range-controller.html">montage/core/range-controller</a></li><li><a href="module-montage_core_serialization.html">montage/core/serialization</a></li><li><a href="module-montage_core_serialization_serializer_montage-serializer.html">montage/core/serialization/serializer/montage-serializer</a></li><li><a href="module-montage_core_shim_array.html">montage/core/shim/array</a></li><li><a href="module-montage_core_shim_object.html">montage/core/shim/object</a></li><li><a href="module-montage_core_shim_string.html">montage/core/shim/string</a></li><li><a href="module-montage_core_state-chart.html">montage/core/state-chart</a></li><li><a href="module-montage_core_undo-manager.html">montage/core/undo-manager</a></li><li><a href="module-montage_core_uuid.html">montage/core/uuid</a></li><li><a href="module-montage_data_object-property.html">montage/data/object-property</a></li><li><a href="module-montage_serialization_serialization.html">montage/serialization/serialization</a></li><li><a href="module-montage_ui_base_abstract-button.html">montage/ui/base/abstract-button</a></li><li><a href="module-montage_ui_base_abstract-control.html">montage/ui/base/abstract-control</a></li><li><a href="module-montage_ui_check-control.html">montage/ui/check-control</a></li><li><a href="module-montage_ui_component.html">montage/ui/component</a></li><li><a href="module-montage_ui_control.html">montage/ui/control</a></li><li><a href="module-montage_ui_controller_media-controller.html">montage/ui/controller/media-controller</a></li><li><a href="module-montage_ui_passage.html">montage/ui/passage</a></li><li><a href="module-montage_ui_text-input.html">montage/ui/text-input</a></li><li><a href="montage_ui_base_abstract-image.module_reel.html">reel</a></li><li><a href="montage_ui_base_abstract-select.module_reel.html">reel</a></li><li><a href="montage_ui_base_abstract-slider.module_reel.html">reel</a></li><li><a href="montage_ui_base_abstract-toggle-button.module_reel.html">reel</a></li><li><a href="montage_ui_base_abstract-toggle-switch.module_reel.html">reel</a></li><li><a href="montage_ui_base_abstract-video.module_reel.html">reel</a></li><li><a href="ui_alert.module_reel.html">reel</a></li><li><a href="ui_base_abstract-progress-bar.module_js.html">js</a></li><li><a href="ui_caption.module_reel.html">reel</a></li><li><a href="ui_draggable-square.module_reel.html">reel</a></li><li><a href="ui_list.module_reel.html">reel</a></li><li><a href="ui_main.module_reel.html">reel</a></li><li><a href="ui_montage-studio-loader.module_reel.html">reel</a></li><li><a href="ui_press-composer-layers.module_reel.html">reel</a></li><li><a href="ui_square.module_reel.html">reel</a></li><li><a href="ui_tree-list.module_reel.html">reel</a></li><li><a href="-_rotation-composer.module_reel.html">reel</a></li></ul><h3>Externals</h3><ul><li><a href="external-Array.html">Array</a></li><li><a href="external-Function.html">Function</a></li><li><a href="external-Object.html">Object</a></li><li><a href="external-RegExp.html">RegExp</a></li><li><a href="external-String.html">String</a></li></ul><h3>Classes</h3><ul><li><a href="AbstractCheckbox.html">AbstractCheckbox</a></li><li><a href="AbstractLink.html">AbstractLink</a></li><li><a href="AbstractNumberField.html">AbstractNumberField</a></li><li><a href="AbstractRadioButton.html">AbstractRadioButton</a></li><li><a href="AbstractTextArea.html">AbstractTextArea</a></li><li><a href="AbstractTextField.html">AbstractTextField</a></li><li><a href="Alias.html">Alias</a></li><li><a href="Authorization.html">Authorization</a></li><li><a href="AuthorizationManager.html">AuthorizationManager</a></li><li><a href="AuthorizationService.html">AuthorizationService</a></li><li><a href="BlueprintDataMapping.html">BlueprintDataMapping</a></li><li><a href="ConnectionDescriptor.html">ConnectionDescriptor</a></li><li><a href="DataIdentifier.html">DataIdentifier</a></li><li><a href="DataMapping.html">DataMapping</a></li><li><a href="DataObjectDescriptor.html">DataObjectDescriptor</a></li><li><a href="DataOperation.html">DataOperation</a></li><li><a href="DataOrdering.html">DataOrdering</a></li><li><a href="DataPropertyDescriptor.html">DataPropertyDescriptor</a></li><li><a href="DataProvider.html">DataProvider</a></li><li><a href="DataQuery.html">DataQuery</a></li><li><a href="DataSelector.html">DataSelector</a></li><li><a href="DataService.html">DataService</a></li><li><a href="DataStream.html">DataStream</a></li><li><a href="DerivedDescriptor.html">DerivedDescriptor</a></li><li><a href="ElementReference.html">ElementReference</a></li><li><a href="Enumeration.html">Enumeration</a></li><li><a href="EventDescriptor.html">EventDescriptor</a></li><li><a href="ExpressionDataMapping.html">ExpressionDataMapping</a></li><li><a href="Flow.html">Flow</a></li><li><a href="FlowTranslateComposer.html">FlowTranslateComposer</a></li><li><a href="HttpService.html">HttpService</a></li><li><a href="HttpService.DataType.html">DataType</a></li><li><a href="ImageGallery.html">ImageGallery</a></li><li><a href="ImageGalleryItem.html">ImageGalleryItem</a></li><li><a href="IndexedDBDataService.html">IndexedDBDataService</a></li><li><a href="Main.html">Main</a></li><li><a href="MappingRule.html">MappingRule</a></li><li><a href="Message.html">Message</a></li><li><a href="MessageFormat.html">MessageFormat</a></li><li><a href="Model.html">Model</a></li><li><a href="ModelGroup.html">ModelGroup</a></li><li><a href="module-_._foo.reel_.Foo.html">Foo</a></li><li><a href="module-_montage_ui_condition.reel_-Condition.html">Condition</a></li><li><a href="module-_montage_ui_flow.reel_-Flow.html">Flow</a></li><li><a href="module-_montage_ui_loader.reel_-Loader.html">Loader</a></li><li><a href="module-_montage_ui_native_button.reel_.Button.html">Button</a></li><li><a href="module-_montage_ui_native_checkbox.reel_.Checkbox.html">Checkbox</a></li><li><a href="module-_montage_ui_native_image.reel_.Image.html">Image</a></li><li><a href="module-_montage_ui_native_input-date.reel_.InputDate.html">InputDate</a></li><li><a href="module-_montage_ui_native_input-number.reel_.InputNumber.html">InputNumber</a></li><li><a href="module-_montage_ui_native_input-radio.reel_.InputRadio.html">InputRadio</a></li><li><a href="module-_montage_ui_native_input-range.reel_.InputRange.html">InputRange</a></li><li><a href="module-_montage_ui_native_input-text.reel_.InputText.html">InputText</a></li><li><a href="module-_montage_ui_native_progress.reel_.Progress.html">Progress</a></li><li><a href="module-_montage_ui_native_select.reel_.Select.html">Select</a></li><li><a href="module-_montage_ui_native_textarea.reel_.Textarea.html">Textarea</a></li><li><a href="module-_montage_ui_repetition.reel_-Iteration.html">Iteration</a></li><li><a href="module-_montage_ui_repetition.reel_-Repetition.html">Repetition</a></li><li><a href="module-_montage_ui_segmented-bar.reel_-SegmentedBar.html">SegmentedBar</a></li><li><a href="module-_montage_ui_slot.reel_-Slot.html">Slot</a></li><li><a href="module-_montage_ui_substitution.reel_-Substitution.html">Substitution</a></li><li><a href="module-_montage_ui_succession.reel_-Succession.html">Succession</a></li><li><a href="module-_ui_anchor.reel_.Anchor.html">Anchor</a></li><li><a href="module-_ui_main.reel_.Main.html">Main</a></li><li><a href="module-_ui_modal-overlay.reel_-ModalOverlay.html">ModalOverlay</a></li><li><a href="module-_ui_overlay.reel_-Overlay.html">Overlay</a></li><li><a href="module-_ui_segmented-bar.reel_segment.reel_.Segment.html">Segment</a></li><li><a href="module-core_application-Application.html">Application</a></li><li><a href="module-montage_composer_composer-Composer.html">Composer</a></li><li><a href="module-montage_composer_key-composer-KeyComposer.html">KeyComposer</a></li><li><a href="module-montage_composer_press-composer-PressComposer.html">PressComposer</a></li><li><a href="module-montage_composer_swipe-composer-SwipeComposer.html">SwipeComposer</a></li><li><a href="module-montage_composer_translate-composer-TranslateComposer.html">TranslateComposer</a></li><li><a href="module-montage_core_bitfield-BitField.html">BitField</a></li><li><a href="module-montage_core_converter_bytes-converter-BytesConverter.html">BytesConverter</a></li><li><a href="module-montage_core_converter_camel-case-converter-CamelCaseConverter.html">CamelCaseConverter</a></li><li><a href="module-montage_core_converter_converter-Converter.html">Converter</a></li><li><a href="module-montage_core_converter_converter-Validator.html">Validator</a></li><li><a href="module-montage_core_converter_currency-converter-CurrencyConverter.html">CurrencyConverter</a></li><li><a href="module-montage_core_converter_date-converter-DateConverter.html">DateConverter</a></li><li><a href="module-montage_core_converter_date-converter-DateValidator.html">DateValidator</a></li><li><a href="module-montage_core_converter_invert-converter-InvertConverter.html">InvertConverter</a></li><li><a href="module-montage_core_converter_kebab-case-converter-KebabCaseConverter.html">KebabCaseConverter</a></li><li><a href="module-montage_core_converter_lower-case-converter-LowerCaseConverter.html">LowerCaseConverter</a></li><li><a href="module-montage_core_converter_new-line-to-br-converter-NewLineToBrConverter.html">NewLineToBrConverter</a></li><li><a href="module-montage_core_converter_number-converter-NumberConverter.html">NumberConverter</a></li><li><a href="module-montage_core_converter_number-converter-NumberValidator.html">NumberValidator</a></li><li><a href="module-montage_core_converter_number-to-nearest-integer-converter-NumberToNearestIntegerConverter.html">NumberToNearestIntegerConverter</a></li><li><a href="module-montage_core_converter_snake-case-converter-SnakeCaseConverter.html">SnakeCaseConverter</a></li><li><a href="module-montage_core_converter_trim-converter-ExpressionConverter.html">ExpressionConverter</a></li><li><a href="module-montage_core_converter_trim-converter-TrimConverter.html">TrimConverter</a></li><li><a href="module-montage_core_converter_upper-case-converter-UpperCaseConverter.html">UpperCaseConverter</a></li><li><a href="module-montage_core_core-Montage.html">Montage</a></li><li><a href="module-montage_core_enum-Enum.html">Enum</a></li><li><a href="module-montage_core_event_action-event-listener-ActionEventListener.html">ActionEventListener</a></li><li><a href="module-montage_core_event_event-manager-EventManager.html">EventManager</a></li><li><a href="module-montage_core_event_key-manager-KeyManager.html">KeyManager</a></li><li><a href="module-montage_core_event_mutable-event-MutableEvent.html">MutableEvent</a></li><li><a href="module-montage_core_exception-Exception.html">Exception</a></li><li><a href="module-montage_core_gate-Gate.html">Gate</a></li><li><a href="module-montage_core_geometry_cubic-bezier-CubicBezier.html">CubicBezier</a></li><li><a href="module-montage_core_geometry_point-Point.html">Point</a></li><li><a href="module-montage_core_localizer-Localizer.html">Localizer</a></li><li><a href="module-montage_core_localizer-Message.html">Message</a></li><li><a href="module-montage_core_logger-Logger.html">Logger</a></li><li><a href="module-montage_core_meta_validation-rule-PropertyValidationRule.html">PropertyValidationRule</a></li><li><a href="module-montage_core_module-reference-ModuleReference.html">ModuleReference</a></li><li><a href="module-montage_core_object-controller-ObjectController.html">ObjectController</a></li><li><a href="module-montage_core_range-controller-RangeController.html">RangeController</a></li><li><a href="module-montage_core_state-chart-State.html">State</a></li><li><a href="module-montage_core_state-chart-StateChart.html">StateChart</a></li><li><a href="module-montage_core_uuid-Uuid.html">Uuid</a></li><li><a href="module-montage_data_object-property-ObjectProperty.html">ObjectProperty</a></li><li><a href="module-montage_serialization_serialization-Serialization.html">Serialization</a></li><li><a href="module-montage_serialization_serialization-SerializationExtractor.html">SerializationExtractor</a></li><li><a href="module-montage_serialization_serialization-SerializationInspector.html">SerializationInspector</a></li><li><a href="module-montage_serialization_serialization-SerializationMerger.html">SerializationMerger</a></li><li><a href="module-montage_ui_base_abstract-button-AbstractButton.html">AbstractButton</a></li><li><a href="module-montage_ui_base_abstract-control-AbstractControl.html">AbstractControl</a></li><li><a href="module-montage_ui_check-input.CheckControl.html">CheckControl</a></li><li><a href="module-montage_ui_component-Component.html">Component</a></li><li><a href="module-montage_ui_component-RootComponent.html">RootComponent</a></li><li><a href="module-montage_ui_control.Control.html">Control</a></li><li><a href="module-montage_ui_controller_media-controller-MediaController.html">MediaController</a></li><li><a href="module-montage_ui_passage-Passage.html">Passage</a></li><li><a href="module-montage_ui_text.Text.html">Text</a></li><li><a href="module-montage_ui_text-input.TextInput.html">TextInput</a></li><li><a href="ModuleObjectDescriptor.html">ModuleObjectDescriptor</a></li><li><a href="ModuleReference.html">ModuleReference</a></li><li><a href="montage_ui_base_abstract-image.module_reel-AbstractImage.html">AbstractImage</a></li><li><a href="montage_ui_base_abstract-select.module_reel-AbstractSelect.html">AbstractSelect</a></li><li><a href="montage_ui_base_abstract-slider.module_reel-AbstractSlider.html">AbstractSlider</a></li><li><a href="montage_ui_base_abstract-toggle-button.module_reel-AbstractToggleButton.html">AbstractToggleButton</a></li><li><a href="montage_ui_base_abstract-toggle-switch.module_reel-AbstractToggleSwitch.html">AbstractToggleSwitch</a></li><li><a href="montage_ui_base_abstract-video.module_reel-AbstractVideo.html">AbstractVideo</a></li><li><a href="MontageBuilder.html">MontageBuilder</a></li><li><a href="MontageReviver.html">MontageReviver</a></li><li><a href="ObjectDescriptor.html">ObjectDescriptor</a></li><li><a href="PersistentDataService.html">PersistentDataService</a></li><li><a href="PipelineConverter.html">PipelineConverter</a></li><li><a href="PromiseController.html">PromiseController</a></li><li><a href="PropertyDescriptor.html">PropertyDescriptor</a></li><li><a href="PropertyValidationSemantics.html">PropertyValidationSemantics</a></li><li><a href="RadioButtonController.html">RadioButtonController</a></li><li><a href="RangeController.html">RangeController</a></li><li><a href="RawDataService.html">RawDataService</a></li><li><a href="RawPropertyValueToObjectConverter.html">RawPropertyValueToObjectConverter</a></li><li><a href="SnapshotService.html">SnapshotService</a></li><li><a href="Target.html">Target</a></li><li><a href="Template.html">Template</a></li><li><a href="TemplateResources.html">TemplateResources</a></li><li><a href="ui_alert.module_reel-Alert.html">Alert</a></li><li><a href="ui_base_abstract-progress-bar.module_js-AbstractProgressBar.html">AbstractProgressBar</a></li><li><a href="ui_caption.module_reel-Caption.html">Caption</a></li><li><a href="ui_draggable-square.module_reel-DraggableSquare.html">DraggableSquare</a></li><li><a href="ui_list.module_reel-List.html">List</a></li><li><a href="ui_main.module_reel-Main.html">Main</a></li><li><a href="ui_montage-studio-loader.module_reel-MontageStudioLoader.html">MontageStudioLoader</a></li><li><a href="ui_press-composer-layers.module_reel-PressComposerLayers.html">PressComposerLayers</a></li><li><a href="ui_square.module_reel-Square.html">Square</a></li><li><a href="ui_tree-list.module_reel-TreeList.html">TreeList</a></li><li><a href="UserInterfaceDescriptor.html">UserInterfaceDescriptor</a></li><li><a href="-_rotation-composer.module_reel-RotationComposer.html">RotationComposer</a></li></ul><h3>Events</h3><ul><li><a href="AbstractButton.html#event:action">action</a></li><li><a href="AbstractButton.html#event:longAction">longAction</a></li><li><a href="AbstractCheckbox.html#.event:action">action</a></li><li><a href="AbstractCheckbox.html#event:action">action</a></li><li><a href="AbstractControl.html#event:action">action</a></li><li><a href="AbstractLink.html#.event:action">action</a></li><li><a href="AbstractLink.html#event:action">action</a></li><li><a href="AbstractNumberField.html#event:action">action</a></li><li><a href="AbstractRadioButton.html#.event:action">action</a></li><li><a href="AbstractRadioButton.html#event:action">action</a></li><li><a href="AbstractSelect.html#.event:action">action</a></li><li><a href="AbstractTextField.html#.event:action">action</a></li><li><a href="AbstractTextField.html#event:action">action</a></li><li><a href="AbstractToggleButton.html#.event:action">action</a></li><li><a href="AbstractToggleButton.html#.event:longAction">longAction</a></li><li><a href="AbstractToggleSwitch.html#.event:action">action</a></li><li><a href="module-montage_ui_control.html#~event:longpress">longpress</a></li><li><a href="module-_montage_ui_native_button.reel_.Button.html#.event:action">action</a></li><li><a href="module-_montage_ui_native_button.reel_.Button.html#.event:hold">hold</a></li><li><a href="module-_montage_ui_segmented-bar.reel_-SegmentedBar.html#event:action">action</a></li><li><a href="module-_montage_ui_segmented-bar.reel_-SegmentedBar.html#event:longAction">longAction</a></li><li><a href="module-montage_ui_base_abstract-button-AbstractButton.html#event:action">action</a></li><li><a href="montage_ui_base_abstract-select.module_reel-AbstractSelect.html#event:action">action</a></li><li><a href="montage_ui_base_abstract-slider.module_reel-AbstractSlider.html#event:action">action</a></li><li><a href="montage_ui_base_abstract-toggle-button.module_reel-AbstractToggleButton.html#event:action">action</a></li><li><a href="montage_ui_base_abstract-toggle-switch.module_reel-AbstractToggleSwitch.html#event:action">action</a></li><li><a href="Overlay.html#.event:dismiss">dismiss</a></li><li><a href="PressComposer.html#.event:longPress">longPress</a></li><li><a href="PressComposer.html#.event:press">press</a></li><li><a href="PressComposer.html#.event:pressCancel">pressCancel</a></li><li><a href="PressComposer.html#.event:pressStart">pressStart</a></li><li><a href="RotationComposer.html#.event:rotation">rotation</a></li><li><a href="RotationComposer.html#.event:rotationStart">rotationStart</a></li><li><a href="SegmentedBar.html#event:action">action</a></li><li><a href="UndoManager.html#.event:operationRegistered">operationRegistered</a></li><li><a href="UndoManager.html#.event:redo">redo</a></li><li><a href="UndoManager.html#.event:undo">undo</a></li></ul><h3>Namespaces</h3><ul><li><a href="EventManager.html">EventManager</a></li></ul><h3>Global</h3><ul><li><a href="global.html#_isLinkLoadEventAvailable">_isLinkLoadEventAvailable</a></li><li><a href="global.html#_offlinePrimaryKeys">_offlinePrimaryKeys</a></li><li><a href="global.html#_webkitVersion">_webkitVersion</a></li><li><a href="global.html#addPrimaryKeyDependency">addPrimaryKeyDependency</a></li><li><a href="global.html#AuthorizationPolicy">AuthorizationPolicy</a></li><li><a href="global.html#childrenExpression">childrenExpression</a></li><li><a href="global.html#childrenFromNode">childrenFromNode</a></li><li><a href="global.html#collapseAll">collapseAll</a></li><li><a href="global.html#collapseNode">collapseNode</a></li><li><a href="global.html#compiledSyntax">compiledSyntax</a></li><li><a href="global.html#converters">converters</a></li><li><a href="global.html#createDefaultBlueprintForObject">createDefaultBlueprintForObject</a></li><li><a href="global.html#createDefaultObjectDescriptorForObject">createDefaultObjectDescriptorForObject</a></li><li><a href="global.html#data">data</a></li><li><a href="global.html#deserialize">deserialize</a></li><li><a href="global.html#determinate">determinate</a></li><li><a href="global.html#error">error</a></li><li><a href="global.html#expandAll">expandAll</a></li><li><a href="global.html#expandNode">expandNode</a></li><li><a href="global.html#expression">expression</a></li><li><a href="global.html#fooCount">fooCount</a></li><li><a href="global.html#fulfilled">fulfilled</a></li><li><a href="global.html#group">group</a></li><li><a href="global.html#handleTreeChange">handleTreeChange</a></li><li><a href="global.html#identifier">identifier</a></li><li><a href="global.html#initiallyExpanded">initiallyExpanded</a></li><li><a href="global.html#initMontage">initMontage</a></li><li><a href="global.html#initWithExpression">initWithExpression</a></li><li><a href="global.html#initWithObjects">initWithObjects</a></li><li><a href="global.html#initWithPath">initWithPath</a></li><li><a href="global.html#initWithSyntax">initWithSyntax</a></li><li><a href="global.html#isNodeExpanded">isNodeExpanded</a></li><li><a href="global.html#manager">manager</a></li><li><a href="global.html#MontageInterpreter">MontageInterpreter</a></li><li><a href="global.html#ok">ok</a></li><li><a href="global.html#parameters">parameters</a></li><li><a href="global.html#pending">pending</a></li><li><a href="global.html#progress">progress</a></li><li><a href="global.html#progressState">progressState</a></li><li><a href="global.html#promise">promise</a></li><li><a href="global.html#referenceFromValue">referenceFromValue</a></li><li><a href="global.html#rejected">rejected</a></li><li><a href="global.html#state">state</a></li><li><a href="global.html#syntax">syntax</a></li><li><a href="global.html#value">value</a></li><li><a href="global.html#valueFromReference">valueFromReference</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.2</a> on Wed Nov 15 2017 12:53:29 GMT-0800 (PST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
